job:
    name: test-nginx
    #cluster:
    parallelism: 1
    timeCharacteristic: EventTime
    #checkpointingInterval: 10000 #ms
    #avg: com.dfire.platform:sunset-sql:0.0.1-SNAPSHOT
    #jarPath: /Users/dongbinglin/Code/platform/alchemy/alchemy-connectors/target/alchemy-connectors-1.0-SNAPSHOT.jar
    table:
#        sql: select * from  TaxiRides
        sources:
          - name: ngx_log
            schema:
              - name: syslog_host
                type: VARCHAR
              - name: syslog_tag
                type: VARCHAR
              - name: remote_addr
                type: VARCHAR
              - name: remote_user
                type: VARCHAR
              - name: time_local
                type: VARCHAR
              - name: http_method
                type: VARCHAR
              - name: request
                type: VARCHAR
              - name: request_param
                type: VARCHAR
              - name: http_version
                type: FLOAT
              - name: status
                type: INT
              - name: body_bytes_sent
                type: INT
              - name: http_referer
                type: VARCHAR
              - name: user_agent
                type: VARCHAR
              - name: url
                type: VARCHAR
              - name: host_name
                type: VARCHAR
              - name: http_x_forwarded_for
                type: VARCHAR
              - name: request_time
                type: FLOAT
              - name: remote_port
                type: VARCHAR
              - name: upstream_response_time
                type: VARCHAR
              - name: http_x_readtime
                type: VARCHAR
              - name: uri
                type: VARCHAR
              - name: upstream_status
                type: VARCHAR
              - name: upstream_addr
                type: VARCHAR
              - name: nuid
                type: VARCHAR
              - name: request_id
                type: VARCHAR
              - name: http_x_forwarded_proto
                type: VARCHAR
              - name: message
                type: VARCHAR
#              - name: timestamp
#                type: TIMESTAMP
#                rowtime:
#                  timestamps:
#                    type: "from-field"
#                    from: "timestamp"
            connector:
              property-version: 1
              type: kafka
              version: 0.10
              topic: app-log
            #  startup-mode: earliest-offset
              properties:
                 - key: zookeeper.connect
                   value: zk1.2dfire-daily.com:2181/kafka1
                 - key: bootstrap.servers
                   value: 10.1.22.8:9092,10.1.22.7:9092
                 - key: group.id
                   value: testGroup
            format:
              property-version: 1
              type: grok
              regular: \[%{DATA:syslog_host}\] \[%{DATA:syslog_tag}\] "%{IP:remote_addr}" "%{DATA:remote_user}" "\[%{HTTPDATE:time_local}\]" "%{WORD:http_method} %{URIPATH:request}(?:\?%{DATA:request_param}|) HTTP\/%{NUMBER:http_version:float}" "(?:%{NUMBER:status:integer}|-)" "(?:%{NUMBER:body_bytes_sent:integer}|-)" "%{DATA:http_referer}" "%{DATA:user_agent}" "%{WORD} %{DATA:url}" "%{DATA:host_name}" "%{DATA:http_x_forwarded_for}" "(?:%{NUMBER:request_time:float}|%{DATA})" "%{DATA:remote_port}" "(?:%{DATA:upstream_response_time}|-)" "%{DATA:http_x_readtime}" "(?:/%{DATA:uri}|%{DATA})" "%{DATA:upstream_status}" "%{DATA:upstream_addr}" "%{DATA:nuid}" "%{DATA:request_id}" "%{DATA:http_x_forwarded_proto}"
        sinks:
            - name: esSink
              index: sg-ngx-acc
              type: elasticsearch
              address: 10.1.21.61:9300
              clusterName: daily
#              filedIndex: index
              dateFormat: yyyy.MM.dd.HH
